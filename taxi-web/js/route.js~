
var map, osm_layer, vector_layer, point_layer;
var epsg_4326, epsg_900913;
var proj_opts;
        
function init(){
	epsg_4326 = new OpenLayers.Projection("EPSG:4326");
	epsg_900913 = new OpenLayers.Projection("EPSG:900913");
	proj_opts = {
		'internalProjection': epsg_900913,
		'externalProjection': epsg_4326
	};

	map = new OpenLayers.Map('map');

	osm_layer = new OpenLayers.Layer.OSM("OpenLayers OSM");
	vector_layer = new OpenLayers.Layer.Vector("routelayer", {
			styleMap: new OpenLayers.StyleMap(new OpenLayers.Style({
			strokeColor: "#000000",
			strokeWidth: 2
		}))
	});
	point_layer = new OpenLayers.Layer.Vector("pointlayer");

	map.addLayers([osm_layer, vector_layer, point_layer]);

	map.setCenter(new OpenLayers.LonLat(12953390, 4848000), 11);
}

function get_track_data(filename) {
	if (filename) {
		$.ajax({
			url: "../data/" + filename,
  			success: plot_track
		});
	}
}

function plot_track(jsondata) {
	var geojsoner = new OpenLayers.Format.GeoJSON(proj_opts);
	var features = geojsoner.read(jsondata);
	if(features) {
		if(features.constructor != Array) {
			features = [features];
		}
        vector_layer.addFeatures(features);
	}else{          
	}
}
